<% layout('layouts/boilerplate') %>
<%- include('../partials/navbar.ejs') %>
<%- include('../partials/flash.ejs') %>

<div class="container mt-4">
  <h1 class="text-center mb-4 text-orange">All Products</h1>

  <div class="row g-4">
    <% for(let product of products){ %>
      <div class="col-lg-3 col-md-6">
        <div class="card position-relative h-100 bg-dark text-white shadow-sm">

          <!-- Product Image -->
          <img src="<%= product.img %>" class="card-img-top" alt="item image">

          <!-- Sale badge example (optional) -->
          <span class="badge-sale">50% OFF</span>

          <div class="card-body d-flex flex-column">
            <!-- Title & Wishlist -->
            <h5 class="card-title d-flex justify-content-between align-items-center text-orange">
              <span><%= product.name %></span>
              <span class="like-btn" product-id="<%= product._id %>">
                <% if(currentUser && currentUser.wishList.includes(product._id)){ %>
                  <i class="fas fa-heart text-danger"></i> <!-- filled red -->
                <% } else { %>
                  <i class="far fa-heart text-orange"></i> <!-- outlined orange -->
                <% } %>
              </span>
            </h5>

            <!-- Rating & Reviews -->
            <div class="mb-2">
              <span class="badge rounded-pill bg-secondary text-white me-2">
                <%= product.avgRating %> â˜…
              </span>
              <small class="text-muted">(<%= product.reviews.length %> reviews)</small>
            </div>

            <!-- Description -->
            <p class="card-text text-light small">
              <%= product.desc %>
            </p>

            <!-- Price -->
            <h6 class="mt-auto text-orange">
              <span class="text-decoration-line-through text-muted">
                Rs.<%= product.price * 2 %>
              </span>
              <span class="fw-bold ms-2">
                Rs.<%= product.price %>
              </span>
            </h6>

            <!-- Button -->
            <a href="/product/<%= product._id %>" class="btn btn-outline-orange btn-sm mt-3 w-100">
              View Now
            </a>
          </div>
        </div>
      </div>
    <% } %>
  </div>
</div>

<script src="/js/common.js"></script>
